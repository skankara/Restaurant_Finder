<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script src="../JS/ajax.js"></script>
<link rel="stylesheet" href="../CSS/popup.css">
<link rel="stylesheet" href="../CSS/generic.css">
<link rel="stylesheet" href="../CSS/SplitScreen.css">
<!--<script src="../JS/popup.js"></script>  -->
<script>
        $(document).ready(function(){
        	$("#submit_Oracle").click(function(){
        		
        		var l_firstsignup_2 = document.getElementById("firstsignup_1").checked;
        		var l_firstlogin_2 = document.getElementById("firstlogin_1").checked;
        		var l_user_2 = document.getElementById("user").checked;
        		var l_restaurant_2 = document.getElementById("restaurant").checked;
        		var url = null ;
        		var backslash = '/' ;
        		if(l_user_2 == true && l_firstsignup_2 == true )
        		{
        			url = "http://localhost:8080/UserManagement/rest/UserService/post/user/"; 
        			
           			url = url + document.getElementsByName('uemail')[0].value+backslash+
            					document.getElementsByName("upassword")[0].value+backslash+
            					document.getElementsByName("uname")[0].value+backslash+
             					document.getElementsByName("ulastname")[0].value+backslash+
             					document.getElementsByName("ucity")[0].value+backslash+
             					document.getElementsByName("ustate")[0].value;
        			
        			console.log(url);
        			$.post(url);
        			document.getElementById('myModal').style.display = "none";
            		console.log("Success");
        		}
        		if(l_restaurant_2 == true && l_firstsignup_2 == true)
       			{
        			url = "http://localhost:8080/UserManagement/rest/UserService/post/restaurant/" ;
        			url = url + document.getElementsByName('remail')[0].value+backslash+
								document.getElementsByName("rpassword")[0].value+backslash+
								document.getElementsByName("rname")[0].value+backslash+
			 					document.getElementsByName("rcity")[0].value+backslash+
			 					document.getElementsByName("rstate")[0].value+backslash+
			 					document.getElementsByName("prange")[0].value+backslash+
			 					document.getElementsByName("rstyle")[0].value; 	
    
        			$.post(url);
        			document.getElementById('myModal').style.display = "none";
            		console.log("Success");
       			}
        		if(l_user_2 == true && l_firstlogin_2 == true)
        		{
        			url = "http://localhost:8080/UserManagement/rest/UserService/get/users/" ;
        			url = url + document.getElementsByName('uemail_1')[0].value+backslash+
					document.getElementsByName("upassword_1")[0].value;
        			
        			$.ajax({
        				type: 'GET',url:url,crossDomain: true,dataType: "xml",xhrFields: {withCredentials: false},
        				headers: {"Access-Control-Allow-Headers": "*", "Access-Control-Allow-Origin":"*"},success: function(xml) {
        					var name = $(xml).find('name').first().text() + " "+$(xml).find('surname').first().text();
        					console.log("name : "+name);
        					document.getElementById('myModal').style.display = "none";
        					document.getElementById("signup").innerHTML = name;
        					//window.close();
        				},error: function() {}
        			});
        			
        		<!--	url = "http://localhost:8080/UserManagement/rest/UserService/get/Neo4J/restaurant/Sreee/Data/k"
        			$.ajax({
        				type: 'GET',url:url,crossDomain: true,dataType: "xml",xhrFields: {withCredentials: false},
        				headers: {"Access-Control-Allow-Headers": "*", "Access-Control-Allow-Origin":"*"},error: function() {}
        			});
        			-->
        			/* $.get(url, contentType: 'text/plain',xhrFields: {withCredentials: false},headers: {},success: function() {},error: function() {}); */
        		}
        		
        		if(l_restaurant_2 == true && l_firstlogin_2 == true)
        		{
        			url = "http://localhost:8080/UserManagement/rest/UserService/get/users/restaurant/" ;
        			url = url + document.getElementsByName('uemail_1')[0].value+backslash+
					document.getElementsByName("upassword_1")[0].value;
        			
        			$.ajax({
        				type: 'GET',url:url,crossDomain: true,dataType: "xml",xhrFields: {withCredentials: false},
        				headers: {"Access-Control-Allow-Headers": "*", "Access-Control-Allow-Origin":"*"},success: function(xml) {
        					var name = $(xml).find('name').first().text() ;
        					console.log("name : "+name);
        					document.getElementById('myModal').style.display = "none";
        					document.getElementById("signup").innerHTML = name;
        					//window.close();
        				},error: function() {}
        			});
        		}
        		console.log(url);
        	})
        })
        function close_window(){
    		window.opener.location = 'pop_up.php';
    		window.close();
			}
</script>

<style>
img {
  border-radius: 40%;
}
/* Style the footer */
/* header {
    background-color: #666;
    padding: 0px; 
    text-align: center;
    font-size: 30px;
    color: white;
} */
table{
background-color: #666;
    padding: 0px; 
    text-align: center;
    font-size: 30px;
    color: white;
}
footer {
    background-color: #777;
    padding: 10px; 
    text-align: center;
    color: white;
}
li a {
    display: block;
    color: white;
    text-align: center;
    padding: 16px;
    text-decoration: none;
}
body {
background-color: #777;
}
</style>
</head>

<body>


<div class="container">
  <div class="toppane">
	<table >
		<tr>
		<td width = "20%">
		<img  width="90%" height="10%" src="../SRC/profile-pic.jpeg" >
		</td>
		<td width = "60%" >	
		<h2>Welcome to the world of Food</h2>
		<ul id="menu">
			<div class = "dropdown">
	        	<li>CITY</li>
	        	<div class="dropdown-content" >
		    		<input type="checkbox" name = "l_city" value = "Indinapolis" >dfdsgdfgdfgfd<br>
		    		<input type="checkbox" name = "l_city" value = "Chicago" >Link_2<br>
		    		<input type="checkbox" name = "l_city" value = "Nashville">Link_3<br>
	  			</div>
        	</div>
        	<div class = "dropdown">
	        	<li>PRICE-RANGE</li>
	        	<div class="dropdown-content">
		    		<input type="checkbox" name = "l_price" value = "$" >$<br>
		    		<input type="checkbox" name = "l_price" value = "$-$$" >$-$$<br>
		    		<input type="checkbox" name = "l_price" value = "$$-$$$">$$-$$$<br>
		    		<input type="checkbox" name = "l_price" value = "$$$-$$$$">$$$-$$$$<br>
	  			</div>
        	</div>
        	<div class = "dropdown">
		        <li>CUISINE STYLE</li>
		        <div class="dropdown-content">
			    	<input type="checkbox" name = "l_style" value = "Afghani" > Afghani<br>
		    		<input type="checkbox" name = "l_style" value = "African" >African<br>
		    		<input type="checkbox" name = "l_style" value = "Albanian">Albanian<br>
		    		<input type="checkbox" name = "l_style" value = "American">American<br>
		  		</div>
        	</div>
        	
        	<li><button id = "search" onclick= "Retreive_Checked_Values();Retreive_Restaurants()" >SEARCH</button></li>
		</ul>
		
		</td>
		<td width = "20%" id="signup">Sign Up/Login</td>
		</tr>
	</table> 

</div>
  <div class="leftpane">
    <h1></h1></div>
  <div class="middlepane">
  	
		<!-- <div class = "Restaurantdetails">
		<h1 id = "l_restaurantnames">Restaurant Name</h1>
		<p id = "l_rankings">Details of restaurant and Review</p>
		</div> -->
  	
  </div>
  <div class="rightpane">
    <p align = "center"><b>Restaurants You Might like</b></p>
	<div class = "Restaurantdetails">
	<p id = "l_restaurantnames_right">Restaurant Name</p>
	<p id = "l_rankings_right" >Details of restaurant and Review</p>
	</div>
	<div class = "Restaurantdetails">
	<p>Restaurant Name</p>
	<p>Details of restaurant and Review</p>
	</div></div>
</div>
<!-- POP UP Window Coding -->

<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <div align = "center">
    <input type="radio" name="l_firstsignup" value="firstsignup_1" id ="firstsignup_1" onclick="user_restaurant()">Sign Up
    <input type="radio" name="l_firstsignup" value="firstlogin_1" id="firstlogin_1" onclick="user_restaurant()">Log In<br>
    
    <input type="radio" name="login" value="user" id="user" onclick="user_restaurant()" > User 
  	<input type="radio" name="login" value="restaurant" id="restaurant" onclick="user_restaurant()"> Restaurant Owner
  	
  	
  	<!--  LOGIN STARTS-->
	  	<div id = "login_1" align = "center">
	  	User id :
			<input type="text" name="uemail_1"  value = ""><br>
			  Password:
			  <input type="password" name="upassword_1" value=""><br>
			<button id = "submit_Oracle">Submit</button>  
	  	</div>
  	<!-- LOGIN END  -->
  	
  	<!--  USER SIGNUP STARTS-->
	  	<div id = "userdetails" align ="center" >
	  	<br>
	  		User id :
			<input type="text" name="uemail"  value = "123123456"><br>
			  Password:
			  <input type="password" name="upassword" value="xyz"><br>
			Name :
			<input type="text" name="uname" value="qwe">
			  <br>
			Surname :
			<input type="text" name="ulastname" value="kan">
			  <br>
			City:
			<input type="text" name="ucity" value="rty">
			<br>
			State:
			<input type="text" name="ustate" value="ddfd">
			<br>		
			  <button id = "submit_Oracle">Submit</button>
	  	
	  	</div>
  	<!--  USER SIGNUP ENDS-->
  	
  	<!--  RESTAURANT SIGNUP STARTS-->
	  	<div id = "restaurantdetails" align="center">
	  		<br>
	  		Rataurant id :
			<input type="text" name="remail"  value = "123123456@gmail.com"><br>
			  Password:
			  <input type="password" name="rpassword" value="xyz"><br>
			Restaurant Name :
			<input type="text" name="rname" value="qwe">
			  <br>
			City:
			<input type="text" name="rcity" value="rty">
			<br>
			State:
			<input type="text" name="rstate" value="ddfd">
			<br>
			Price range:
			<input type="radio" name="prange" value="20" checked> $<br>
			  <input type="radio" name="prange" value="50"> $$<br>
			  <input type="radio" name="prange" value="100"> $$$<br>
			  <input type="radio" name="prange" value="200"> $$$$<br>
			
			Cuisine Style :
			  <input type="text" name="rstyle" value="fdfd">
			<br>
			  <br>
			  <button id = "submit_Oracle">Submit</button>
	  	</div>
  	<!--  RESTAURANT SIGNUP ENDS-->
    </div>
  </div>

</div>
<!--  Script for the pop up window -->
<script>
// Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("signup");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

var g_City = null;
var g_Price = null;
var g_Style = null;

// When the user clicks the button, open the modal 
btn.onclick = function() {
    modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}
/* function user_signup(signup){
	
	if(signup.value == "firstlogin"){
		document.getElementById('userdetails').style.display  = 'block';
	}
	
} */


function user_restaurant(){
	
	var l_firstsignup_1 = document.getElementById("firstsignup_1").checked;
	var l_firstlogin_1 = document.getElementById("firstlogin_1").checked;
	var l_user = document.getElementById("user").checked;
	var l_restaurant = document.getElementById("restaurant").checked;
	/* var signup = document.getElementsByName('l_firstsignup')[0].value; */
	
	console.log("firstsignup_1 : "+ l_firstsignup_1);
	
	if(l_user == true && l_firstlogin_1 == true ){
		document.getElementById('userdetails').style.display  = 'none';
		document.getElementById('restaurantdetails').style.display  = 'none';
		document.getElementById('login_1').style.display  = 'block';
	}
	if(l_restaurant == true && l_firstlogin_1 == true ){
		document.getElementById('userdetails').style.display  = 'none';
		document.getElementById('restaurantdetails').style.display  = 'none';
		document.getElementById('login_1').style.display  = 'block';
	}
	
	
	if(l_user == true && l_firstsignup_1 == true ){
		console.log("inside");
		document.getElementById('login_1').style.display  = 'none';
		document.getElementById('userdetails').style.display  = 'block';
		document.getElementById('restaurantdetails').style.display  = 'none';
	}
	if(l_restaurant == true && l_firstsignup_1 == true)
	{
		console.log("in Else");
		document.getElementById('login_1').style.display  = 'none';
		document.getElementById('userdetails').style.display  = 'none';
		document.getElementById('restaurantdetails').style.display  = 'block';
	}
}

function Retreive_Checked_Values(){

	g_City = get_theDataOf_CPC(document.getElementsByName('l_city'));
	console.log("g_City:",g_City);
	g_price = get_theDataOf_CPC(document.getElementsByName('l_price'));
	g_style = get_theDataOf_CPC(document.getElementsByName('l_style'));
	console.log("l_priceURI:",g_price);
	console.log(g_style)
	
	
	/* alert("Thanks for checking me",City); */
}

function get_theDataOf_CPC(inputElements ){
	var l_checkedValue = "";
	for(i=0;i<inputElements.length;i++){
		if(inputElements[i].checked){
	           l_checkedValue = inputElements[i].value+"_"+l_checkedValue;
	      }
	}
	l_checkedValue = l_checkedValue.substring(0,l_checkedValue.length-1);
	return l_checkedValue ;
}

function Retreive_Restaurants()
{
	var backslash = "/";
	if (g_style == null || g_style ==""){
		g_style = "NULL";
	}
	if (g_price == null || g_price ==""){
		g_price = "NULL";
	}
	if (g_City == null || g_City ==""){
		g_City = "NULL";
	}
	
	var url = "http://localhost:8080/UserManagement/rest/UserService/get/Neo4J/restaurant/" ;
	url = url +g_City+backslash+g_price+backslash+g_style;
	console.log(url);
	$.ajax({
		type: 'GET',url:url,crossDomain: true,dataType: "xml",xhrFields: {withCredentials: false},
		headers: {"Access-Control-Allow-Headers": "*", "Access-Control-Allow-Origin":"*"},success: function(xml) {
					
			$(xml).find('Restaurants').each(function(){ 
				
				var restaurant_Name = $(this).find('restaurant_Name').text();
				
				var restaurant_Rating = $(this).find('restaurant_Rating').text();
				console.log(restaurant_Name);
				console.log(restaurant_Rating);
				 $('.middlepane').append(`
						 	<div class="Restaurantdetails">
			                <h1 >${restaurant_Name}</h1>
			                <p>Ranking:${restaurant_Rating}</h1></p>
			                <p>Rating</p>
			                <p>Style</p>
			                
			                    `)
			});
			/* $(xml).find('restaurant_Rating').each(function(index, element){ 
				
				var restaurant_Rating = $(this).text();
				console.log(restaurant_Rating);
				 $('.middlepane').append(`
						 	<div class="Restaurantdetails">
			                <h1 >${restaurant_Name}</h1>
			                <p>${restaurant_Rating}</h1></p>
			                    `)
			});
			 */
			
			
			//window.close();
		},error: function() {}
	});
	
}

</script>
<!-- POP UP Window Closes-->

<!-- <footer>
  <p>Footer</p>
</footer> -->
</body>
</html>